<h1>Your listings</h1>

<%= link_to "Create new listing", new_listing_path %>

<% @user_listings.each do |listing| %>
  <p><br></p>
  <%= render listing %>
  <%= link_to "Show this listing", listing %> | <%= link_to "Edit this listing", edit_listing_path(listing) %>
  <%= link_to "Delete the listing",
    listing_path(listing),
    data: {turbo_method: :delete, turbo_confirm: "Are you sure?"},
    class: "block" %>

  <% listing.bookings.each do |booking| %>
    <div class="py-4">
      <p>Booking from <%= booking.user.email %></p>
      <p>Dates: <%= booking.start_date %> to <%= booking.end_date %></p>
      <% if booking.confirmed? %> <p>Confirmed Booking!</p>
      <% elsif booking.denied? %> <p>Denied Booking!</p>
      <% else %>
        <%= link_to "Confirm the booking",
          booking_path(booking, booking: { status: :confirmed }),
          data: {turbo_method: :patch},
          class: "block" %>
        <%= link_to "Deny the booking",
          booking_path(booking, booking: { status: :denied}),
          data: {turbo_method: :patch},
          class: "block" %>
      <% end %>
    </div>
  <% end %>
<% end %>
